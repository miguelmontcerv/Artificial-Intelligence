= Inteligencia Artificial VII - k-Means


+*In[11]:*+
[source, ipython3]
----
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
----


+*In[14]:*+
[source, ipython3]
----
from sklearn.datasets import make_blobs
----


+*In[60]:*+
[source, ipython3]
----
datos = make_blobs(n_samples = 700, n_features = 2, centers = 4)
datos[0]
----


+*Out[60]:*+
----array([[-4.3548916 ,  6.46337475],
       [ 5.64710551, -1.73961935],
       [ 5.64611757, -2.54715911],
       ...,
       [-9.46296235, -5.0594685 ],
       [ 8.44263216,  1.54570409],
       [ 5.64241628, -0.92333742]])----


+*In[62]:*+
[source, ipython3]
----
#Hicimos muchos puntos aleatorios y los clasificamos en cuatro grupos, veremos graficamente esos puntos
plt.scatter(datos[0][:,0],datos[0][:,1])
----


+*Out[62]:*+
----<matplotlib.collections.PathCollection at 0x145acf2e3c8>
![png](output_4_1.png)
----


+*In[63]:*+
[source, ipython3]
----
from sklearn.cluster import KMeans 
----


+*In[64]:*+
[source, ipython3]
----
model = KMeans(n_clusters = 4)
----


+*In[65]:*+
[source, ipython3]
----
model.fit(datos[0])
----


+*Out[65]:*+
----KMeans(algorithm='auto', copy_x=True, init='k-means++', max_iter=300,
       n_clusters=4, n_init=10, n_jobs=None, precompute_distances='auto',
       random_state=None, tol=0.0001, verbose=0)----


+*In[67]:*+
[source, ipython3]
----
model.cluster_centers_ #Son el punto central de cada grupo
----


+*Out[67]:*+
----array([[ 6.02744049, -2.53015723],
       [-8.72310396, -6.63228799],
       [-3.47636019,  4.68124769],
       [ 8.74412931,  1.14133032]])----


+*In[71]:*+
[source, ipython3]
----
model.labels_
----


+*Out[71]:*+
----array([2, 0, 0, 3, 0, 1, 3, 2, 1, 1, 2, 0, 2, 3, 2, 2, 0, 1, 0, 1, 1, 0,
       2, 3, 3, 0, 3, 3, 2, 3, 0, 0, 2, 1, 2, 1, 3, 3, 1, 0, 3, 1, 2, 3,
       1, 3, 1, 0, 0, 2, 2, 0, 3, 3, 1, 0, 1, 2, 0, 0, 1, 3, 1, 3, 1, 3,
       3, 1, 0, 0, 3, 0, 1, 3, 3, 0, 1, 0, 3, 1, 2, 0, 0, 3, 3, 2, 1, 3,
       2, 0, 3, 0, 1, 2, 0, 0, 2, 3, 3, 2, 0, 0, 3, 3, 0, 2, 2, 3, 1, 1,
       2, 2, 2, 3, 3, 0, 2, 2, 2, 2, 2, 1, 0, 3, 3, 3, 0, 3, 1, 2, 1, 1,
       3, 1, 0, 0, 3, 1, 3, 0, 1, 1, 1, 3, 2, 1, 0, 2, 3, 3, 0, 2, 3, 3,
       0, 3, 0, 3, 0, 0, 2, 3, 3, 0, 1, 2, 3, 0, 2, 0, 1, 3, 3, 1, 3, 2,
       1, 2, 0, 1, 0, 2, 1, 3, 2, 2, 0, 2, 0, 0, 0, 2, 0, 3, 1, 0, 0, 2,
       3, 1, 2, 3, 0, 0, 2, 0, 2, 0, 0, 0, 2, 1, 3, 2, 3, 3, 0, 3, 1, 2,
       1, 1, 0, 3, 3, 1, 1, 1, 3, 2, 1, 0, 3, 2, 3, 3, 1, 0, 2, 0, 0, 3,
       3, 2, 0, 0, 1, 3, 3, 2, 2, 3, 2, 2, 0, 0, 3, 2, 3, 1, 0, 1, 1, 0,
       3, 2, 2, 0, 3, 1, 2, 0, 2, 3, 1, 0, 1, 1, 1, 3, 0, 0, 0, 3, 1, 3,
       0, 3, 3, 0, 3, 2, 1, 1, 2, 1, 2, 0, 1, 3, 3, 2, 1, 2, 3, 2, 1, 2,
       0, 2, 0, 3, 0, 3, 3, 1, 3, 0, 3, 2, 3, 0, 2, 0, 0, 1, 0, 3, 1, 3,
       2, 0, 0, 2, 1, 1, 2, 1, 1, 3, 3, 0, 2, 2, 3, 0, 1, 3, 0, 1, 1, 0,
       0, 2, 1, 2, 3, 1, 3, 1, 0, 1, 2, 3, 1, 1, 1, 3, 2, 0, 2, 0, 1, 1,
       0, 3, 2, 2, 3, 3, 1, 0, 0, 3, 0, 3, 1, 2, 2, 3, 2, 1, 1, 1, 1, 0,
       2, 0, 0, 3, 2, 0, 0, 3, 1, 3, 0, 3, 2, 2, 2, 1, 2, 0, 2, 2, 1, 2,
       3, 1, 3, 0, 3, 2, 0, 2, 1, 1, 2, 3, 3, 3, 1, 2, 1, 1, 0, 3, 1, 0,
       0, 2, 2, 1, 3, 0, 3, 2, 1, 2, 2, 2, 3, 0, 2, 1, 3, 2, 1, 1, 1, 2,
       2, 3, 0, 1, 2, 1, 1, 1, 0, 0, 1, 2, 2, 2, 0, 2, 0, 0, 2, 1, 3, 1,
       1, 3, 0, 3, 2, 2, 3, 3, 2, 0, 0, 3, 1, 2, 3, 1, 2, 3, 1, 1, 1, 2,
       0, 2, 2, 3, 1, 1, 1, 1, 1, 3, 3, 1, 2, 1, 0, 2, 1, 0, 1, 3, 3, 0,
       1, 1, 1, 1, 1, 2, 0, 3, 1, 2, 0, 0, 2, 2, 0, 1, 1, 0, 3, 1, 0, 3,
       0, 1, 1, 2, 2, 0, 1, 0, 0, 0, 2, 0, 1, 1, 2, 3, 2, 3, 1, 2, 3, 2,
       0, 0, 1, 1, 1, 0, 2, 2, 0, 2, 3, 0, 1, 0, 3, 1, 1, 0, 1, 1, 2, 0,
       0, 1, 2, 2, 1, 1, 1, 1, 0, 3, 3, 1, 3, 0, 3, 2, 1, 3, 1, 2, 2, 0,
       2, 2, 0, 0, 1, 0, 2, 2, 3, 3, 1, 3, 0, 0, 3, 2, 0, 3, 1, 3, 0, 2,
       1, 3, 2, 3, 2, 0, 1, 2, 2, 2, 3, 3, 2, 2, 2, 0, 0, 2, 3, 2, 3, 0,
       3, 1, 3, 2, 3, 0, 3, 1, 3, 2, 3, 0, 0, 0, 1, 2, 3, 1, 2, 0, 2, 0,
       1, 0, 0, 2, 2, 1, 2, 2, 2, 3, 2, 3, 3, 1, 3, 1, 3, 0])----


+*In[73]:*+
[source, ipython3]
----
datos[1]
----


+*Out[73]:*+
----array([2, 3, 3, 1, 3, 0, 1, 2, 0, 0, 2, 3, 2, 1, 2, 2, 3, 0, 3, 0, 0, 3,
       2, 1, 1, 3, 1, 1, 2, 1, 3, 3, 2, 0, 2, 0, 1, 1, 0, 3, 1, 0, 2, 1,
       0, 1, 0, 3, 3, 2, 2, 3, 1, 1, 0, 3, 0, 2, 3, 3, 0, 1, 0, 1, 0, 1,
       1, 0, 3, 3, 1, 3, 0, 1, 1, 3, 0, 3, 1, 0, 2, 3, 3, 1, 1, 2, 0, 1,
       2, 3, 1, 3, 0, 2, 3, 3, 2, 1, 1, 2, 3, 3, 1, 1, 3, 2, 2, 1, 0, 0,
       2, 2, 2, 1, 1, 3, 2, 2, 2, 2, 2, 0, 3, 1, 1, 1, 3, 1, 0, 2, 0, 0,
       1, 0, 3, 3, 1, 0, 1, 3, 0, 0, 0, 1, 2, 0, 3, 2, 1, 1, 3, 2, 1, 1,
       3, 1, 3, 1, 3, 3, 2, 1, 1, 3, 0, 2, 1, 3, 2, 3, 0, 1, 1, 0, 1, 2,
       0, 2, 3, 0, 3, 2, 0, 1, 2, 2, 3, 2, 3, 3, 3, 2, 3, 1, 0, 3, 3, 2,
       1, 0, 2, 1, 3, 3, 2, 3, 2, 3, 3, 3, 2, 0, 1, 2, 1, 1, 3, 1, 0, 2,
       0, 0, 3, 1, 1, 0, 0, 0, 1, 2, 0, 3, 1, 2, 1, 1, 0, 3, 2, 3, 3, 1,
       1, 2, 3, 3, 0, 1, 1, 2, 2, 1, 2, 2, 3, 3, 1, 2, 1, 0, 3, 0, 0, 3,
       1, 2, 2, 3, 1, 0, 2, 3, 2, 1, 0, 3, 0, 0, 0, 1, 3, 3, 3, 1, 0, 1,
       3, 1, 1, 3, 1, 2, 0, 0, 2, 0, 2, 3, 0, 1, 1, 2, 0, 2, 1, 2, 0, 2,
       3, 2, 3, 1, 3, 1, 1, 0, 1, 3, 1, 2, 1, 3, 2, 3, 3, 0, 3, 1, 0, 1,
       2, 3, 3, 2, 0, 0, 2, 0, 0, 1, 1, 3, 2, 2, 1, 3, 0, 1, 3, 0, 0, 3,
       3, 2, 0, 2, 1, 0, 1, 0, 3, 0, 2, 1, 0, 0, 0, 1, 2, 3, 2, 3, 0, 0,
       3, 1, 2, 2, 1, 1, 0, 3, 3, 1, 3, 1, 0, 2, 2, 1, 2, 0, 0, 0, 0, 3,
       2, 3, 3, 1, 2, 3, 3, 1, 0, 1, 3, 1, 2, 2, 2, 0, 2, 3, 2, 2, 0, 2,
       1, 0, 1, 3, 1, 2, 3, 2, 0, 0, 2, 1, 1, 1, 0, 2, 0, 0, 1, 1, 0, 3,
       3, 2, 2, 0, 1, 3, 1, 2, 0, 2, 2, 2, 1, 3, 2, 0, 1, 2, 0, 0, 0, 2,
       2, 1, 3, 0, 2, 0, 0, 0, 3, 3, 0, 2, 2, 2, 3, 2, 3, 3, 2, 0, 1, 0,
       0, 1, 3, 1, 2, 2, 1, 1, 2, 3, 3, 1, 0, 2, 1, 0, 2, 1, 0, 0, 0, 2,
       3, 2, 2, 1, 0, 0, 0, 0, 0, 1, 1, 0, 2, 0, 3, 2, 0, 3, 0, 1, 1, 3,
       0, 0, 0, 0, 0, 2, 3, 1, 0, 2, 3, 3, 2, 2, 3, 0, 0, 3, 1, 0, 3, 1,
       3, 0, 0, 2, 2, 3, 0, 3, 3, 3, 2, 3, 0, 0, 2, 1, 2, 1, 0, 2, 1, 2,
       3, 3, 0, 0, 0, 3, 2, 2, 3, 2, 1, 3, 0, 3, 1, 0, 0, 3, 0, 0, 2, 3,
       3, 0, 2, 2, 0, 0, 0, 0, 3, 1, 1, 0, 1, 3, 1, 2, 0, 1, 0, 2, 2, 3,
       2, 2, 3, 3, 0, 3, 2, 2, 1, 1, 0, 1, 3, 3, 1, 2, 3, 1, 0, 1, 3, 2,
       0, 1, 2, 1, 2, 3, 0, 2, 2, 2, 1, 1, 2, 2, 2, 3, 3, 2, 1, 2, 1, 3,
       1, 0, 1, 2, 1, 3, 1, 0, 1, 2, 1, 3, 3, 3, 0, 2, 1, 0, 2, 3, 2, 3,
       0, 3, 3, 2, 2, 0, 2, 2, 2, 1, 2, 1, 1, 0, 3, 0, 1, 3])----


+*In[82]:*+
[source, ipython3]
----
fig, (ax1,ax2) = plt.subplots(1,2,figsize = (12,4))

ax1.scatter(datos[0][:,0] , datos[0][:,1], c = model.labels_ )
ax1.set_title('Algoritmo K-means')

ax2.scatter(datos[0][:,0] , datos[0][:,1], c = datos[1] )
ax2.set_title('Datos Originales')

----


+*Out[82]:*+
----Text(0.5, 1.0, 'Datos Originales')
![png](output_11_1.png)
----


+*In[ ]:*+
[source, ipython3]
----

----
